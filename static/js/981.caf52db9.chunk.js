"use strict";(self.webpackChunkmortal_wombat=self.webpackChunkmortal_wombat||[]).push([[981],{63:function(e,t,n){n.d(t,{G9:function(){return f},Ib:function(){return m},Vx:function(){return d},mu:function(){return y},ni:function(){return x},oL:function(){return p}});var r=n(861),a=n(757),o=n.n(a),i=n(426),s=n(408),c=n(162);(0,i.ZF)({apiKey:"AIzaSyBEserPzSUos4MT3XRO8NKAO2oVk1-LS-I",authDomain:"mortal-wombat-8c76a.firebaseapp.com",projectId:"mortal-wombat-8c76a",storageBucket:"mortal-wombat-8c76a.appspot.com",messagingSenderId:"929181149015",appId:"1:929181149015:web:33a7f450bcdbb06ae64012",measurementId:"G-JL6HCMYYBS"});var u=(0,s.N8)(),l=(0,c.v0)(),h=(0,s.iH)(u),d=function(e,t){try{return console.log("updates",e),(0,s.Vx)(h,e)}catch(n){console.error(n),t(n.message)}};window._update=function(){var e=(0,r.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=console,e.next=3,(0,s.Vx)(h,t);case 3:return e.t1=e.sent,e.abrupt("return",e.t0.log.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var y=function(){var e=(0,r.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Object,e.next=3,Promise.all(t.map(function(){var e=(0,r.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,(0,s.U2)((0,s.iU)(h,t));case 3:return e.t1=e.sent.val(),e.abrupt("return",[e.t0,e.t1]);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return e.t1=e.sent,e.abrupt("return",e.t0.fromEntries.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t,n){try{var r=(0,s.iH)(u,e);return(0,s.jM)(r,(function(e){return t(e.val())})),function(){return(0,s.S1)(r)}}catch(a){console.error(a),n(a.message)}},m=function(e,t){return(0,c.e5)(l,e,t)},f=function(e){return(0,c.Aj)(l,e)},x=function(){return(0,c.w7)(l)}},981:function(e,t,n){n.r(t);var r=n(413),a=n(885),o=n(791),i=n(250),s=n(546),c=n(861),u=n(757),l=n.n(u),h=n(63),d=n(762),y=n(671),p=n(144),m=function(){function e(t,n,a,o){for(var i in(0,y.Z)(this,e),this.blocks=n,this.typeIndex=o,this.frame=0,this.you=(0,r.Z)({x:0,y:0,xs:0,ys:0,dirX:1,dirY:0},t),this.jewels=0,this.digSpeed=.05,this.eatSpeed=.05,this.gravity=.005,this.health=100,this.maxHealth=100,this.poop=0,this.maxPoop=10,this.jumpPower=.11,this.magmaDelay=30,this.moveSpeed=.015,this.moveDeceleration=.3,a)isNaN(a[i])||(this[i]=Number(a[i]))}return(0,p.Z)(e,[{key:"iterate",value:function(e){return this.iterateYou(e),this.frame%this.magmaDelay===0&&this.iterateMagma(),this.frame++,this}},{key:"iterateYou",value:function(e){var t=this.you,n=this.blocks,r=this.gravity;if(this.health<=0)e.KeyR&&location.reload();else{(e.KeyA||e.KeyD||e.KeyW||e.KeyS)&&(t.dirX=0,t.dirY=0),e.KeyA&&(t.xs-=this.moveSpeed,t.dirX--),e.KeyD&&(t.xs+=this.moveSpeed,t.dirX++),e.KeyW&&(t.jumping||t.ys||(t.ys-=this.jumpPower,t.jumping=!0),t.dirY--),e.KeyS&&t.dirY++,t.x+=t.xs,t.xs*=1-this.moveDeceleration,t.ys+=r,t.y+=t.ys;for(var a=0,o=["".concat(Math.floor(t.x),"_").concat(Math.floor(t.y)),"".concat(Math.ceil(t.x),"_").concat(Math.floor(t.y)),"".concat(Math.floor(t.x),"_").concat(Math.ceil(t.y)),"".concat(Math.ceil(t.x),"_").concat(Math.ceil(t.y))];a<o.length;a++){var i=o[a];if(n[i])this.interact(t,n[i],e)&&delete n[i]}}}},{key:"isEmpty",value:function(e,t){return!this.blocks["".concat(e,"_").concat(t)]}},{key:"move",value:function(e,t,n,r){var a="".concat(e,"_").concat(t),o=this.blocks[a];delete this.blocks[a],o.x+=n,o.y+=r,this.blocks["".concat(o.x,"_").concat(o.y)]=o}},{key:"iterateMagma",value:function(){var e,t=Object.values(this.blocks).filter((function(e){return"liquid"===e.type.movement})).sort((function(e,t){return e.y===t.y?Math.random()-.5:e.y-t.y})),n=(0,d.Z)(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(this.isEmpty(r.x,r.y+1))this.move(r.x,r.y,0,1);else{var a=this.isEmpty(r.x-1,r.y),o=this.isEmpty(r.x+1,r.y);a&&o?this.move(r.x,r.y,Math.random()<.5?1:-1,0):a?this.move(r.x,r.y,-1,0):o&&this.move(r.x,r.y,1,0)}}}catch(i){n.e(i)}finally{n.f()}}},{key:"interact",value:function(e,t,n){if(this.onIntersect(t,n))return!0;var r=e.x-t.x,a=e.y-t.y;Math.abs(r)>Math.abs(a)?(e.x=t.x+(e.x<t.x?-1:1),e.xs=0):(e.y<t.y&&(e.jumping=!1),e.y=t.y+(e.y<t.y?-1:1),e.ys=0)}},{key:"onIntersect",value:function(e,t){return e.type.collectible?(this.jewels++,!0):(e.type.healing<0&&(this.health=Math.max(0,this.health+Number(e.type.healing))),!!(e.type.edible&&t.Space&&(void 0===e.eaten&&(e.eaten=1),e.eaten-=this.eatSpeed,this.health=Math.min(this.maxHealth,this.health+e.type.healing*this.eatSpeed),this.poop=Math.min(this.maxPoop,this.poop+e.type.makePoop*this.eatSpeed),e.eaten<=0))||(!!(e.type.diggable&&t.Space&&(void 0===e.dug&&(e.dug=1),e.dug-=this.digSpeed,e.dug<=0))||void 0))}}]),e}(),f=function(){var e=(0,c.Z)(l().mark((function e(){var t,n,r,a,o,i,s,c,u,d,y,p,f,x;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,h.mu)(["tileTypes","world","gameConfig"]);case 2:for(t=e.sent,n=t.tileTypes,r=t.world,a=t.gameConfig,o={},s=0,c=Object.values(n);s<c.length;s++)u=c[s],o[u.id]=u;for(d in r)y=r[d],p=y.x,f=y.y,"w"===(x=y.tileType)?(i={x:p,y:f},delete r[d]):r[d]={x:p,y:f,type:o[x]};if(location.hash.length>1)try{i=JSON.parse(atob(location.hash.slice(1)))}catch(l){console.log("bad hash",l)}return e.abrupt("return",new m(i,r,a,o));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=n(184),v=48,w=function(e){var t=e.you,n=e.children,r=innerWidth/2-t.x*v,a=innerHeight/2-t.y*v;return(0,x.jsx)("div",{style:{transform:"translate(".concat(r,"px,").concat(a,"px)")},children:n})},b=function(e){var t=e.blocks;return Object.entries(t).map((function(e){var t=(0,a.Z)(e,2),n=t[0],r=t[1],o=r.x,i=r.y,c=r.type;return(0,x.jsx)("div",{className:"tile",style:{transform:"translate(".concat(o*v,"px, ").concat(i*v,"px)"),background:(0,s.V)(c)}},n)}))},g=function(e){var t=e.you,n=e.typeIndex,r=Math.atan2(t.dirY,t.dirX)+Math.PI,a=r>=.5*Math.PI&&r<=1.5*Math.PI;return(0,x.jsx)("div",{className:"tile",style:{transform:"\n      translate(".concat(t.x*v,"px,").concat(t.y*v,"px)\n      rotate(").concat(r,"rad)\n      ").concat(a?"scaleY(-1)":""),background:(0,s.V)(n.w)}})},j=function(e){var t=e.value,n=e.maxValue,r=e.color;return(0,x.jsx)("div",{className:"bar",children:(0,x.jsx)("div",{style:{background:r,width:100*t/n+"%"},children:Math.floor(t)})})},k=function(e){var t=e.health,n=e.maxHealth,r=e.poop,a=e.maxPoop,o=e.jewels;return t>0?(0,x.jsxs)("div",{className:"hud",children:[(0,x.jsx)(j,{value:t,maxValue:n,color:t>30?"green":"red"}),(0,x.jsx)(j,{value:r,maxValue:a,color:"saddleBrown"}),(0,x.jsxs)("div",{className:"jewelCounter",children:[o," Jewel",1===o?"":"s"]})]}):(0,x.jsxs)("div",{className:"youDead",children:[(0,x.jsx)("h1",{children:"you dead"}),(0,x.jsx)("h2",{children:"press R to try again"})]})},M=function(e){var t=e.you,n=e.blocks,r=e.health,a=e.maxHealth,o=e.poop,i=e.maxPoop,s=e.jewels,c=e.typeIndex;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(w,{you:t,children:[(0,x.jsx)(b,{blocks:n}),(0,x.jsx)(g,{you:t,typeIndex:c})]}),(0,x.jsx)(k,{health:r,maxHealth:a,poop:o,maxPoop:i,jewels:s})]})},S=function(){var e=(0,o.useRef)(),t=(0,o.useRef)({}),n=(0,o.useState)(0),i=(0,a.Z)(n,2)[1];return(0,o.useEffect)((function(){var n;f().then((function(r){e.current=r,(n=function(){e.current.iterate(t.current),i((function(e){return e+1})),requestAnimationFrame(n)})()}));var r=function(e){return t.current[e.code]="keydown"===e.type};return window.addEventListener("keydown",r),window.addEventListener("keyup",r),function(){window.removeEventListener("keydown",r),window.removeEventListener("keyup",r),cancelAnimationFrame(n)}}),[]),e.current&&(0,x.jsx)(M,(0,r.Z)({},e.current))};(0,i.s)(document.querySelector("#root")).render((0,x.jsx)(o.StrictMode,{children:(0,x.jsx)(S,{})}))},546:function(e,t,n){n.d(t,{V:function(){return r}});var r=function(e){return null!==e&&void 0!==e&&e.image?"no-repeat center/contain url(".concat(e.image,")"):null===e||void 0===e?void 0:e.color}}}]);
//# sourceMappingURL=981.caf52db9.chunk.js.map