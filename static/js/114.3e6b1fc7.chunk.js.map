{"version":3,"file":"static/js/114.3e6b1fc7.chunk.js","mappings":"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","sources":["firebase.js","game/Game.js","game/Renderer.js","game/main.js","utils.js"],"sourcesContent":["import {initializeApp} from 'firebase/app';\nimport {\n  ref,\n  getDatabase,\n  update as _update,\n  onValue,\n  off,\n  get,\n  child,\n  serverTimestamp,\n} from 'firebase/database';\nimport {\n  getAuth,\n  signInWithEmailAndPassword,\n  onAuthStateChanged,\n  signOut,\n} from 'firebase/auth';\nimport {guid} from './utils';\n\ninitializeApp({\n  apiKey: 'AIzaSyBEserPzSUos4MT3XRO8NKAO2oVk1-LS-I',\n  authDomain: 'mortal-wombat-8c76a.firebaseapp.com',\n  projectId: 'mortal-wombat-8c76a',\n  storageBucket: 'mortal-wombat-8c76a.appspot.com',\n  messagingSenderId: '929181149015',\n  appId: '1:929181149015:web:33a7f450bcdbb06ae64012',\n  measurementId: 'G-JL6HCMYYBS',\n});\n\n/*\n\nData:\nhttps://console.firebase.google.com/project/mortal-wombat-8c76a/database/mortal-wombat-8c76a-default-rtdb/data\nData Docs: https://firebase.google.com/docs/database/web/read-and-write?hl=en&authuser=0\n\nUsers:\nhttps://console.firebase.google.com/project/mortal-wombat-8c76a/authentication/users\nUser Docs: https://firebase.google.com/docs/auth/web/manage-users\n\n\n*/\n\nconst db = getDatabase();\nconst auth = getAuth();\nconst dbRef = ref(db);\n\n// {path1: val1, path2: val2}\nexport const update = (updates, onError) => {\n  try {\n    console.log('updates', updates);\n    return _update(dbRef, updates);\n  } catch (e) {\n    console.error(e);\n    onError(e.message);\n  }\n};\n\nexport const updateWithHistory = (data, user, onError) =>\n  update(\n    {\n      ...data,\n      [`history/${guid()}`]: {\n        update: JSON.stringify(data),\n        user: user.email,\n        tstamp: serverTimestamp(),\n      },\n    },\n    onError\n  );\n\nexport const loadData = async (things) =>\n  Object.fromEntries(\n    await Promise.all(\n      things.map(async (t) => [t, (await get(child(dbRef, t))).val()])\n    )\n  );\n\nexport const listen = (pathStr, onChange, onError) => {\n  try {\n    const r = ref(db, pathStr);\n    onValue(r, (snapshot) => onChange(snapshot.val()));\n    return () => off(r);\n  } catch (e) {\n    console.error(e);\n    onError(e.message);\n  }\n};\n\n// export const createUser = async (email, pwd) => {\n//   try {\n//     const result = await createUserWithEmailAndPassword(auth, email, pwd);\n//     return result.user;\n//   } catch (e) {\n//     console.error(e);\n//     return e.message;\n//   }\n// };\n\nexport const logIn = (email, pwd) =>\n  signInWithEmailAndPassword(auth, email, pwd);\n\nexport const listenUser = (onChange) => onAuthStateChanged(auth, onChange);\n\nexport const logOut = () => signOut(auth);\n","const GRASS_HEALTH_AMT = 5;\nconst MAGMA_DAMAGE = 2;\n\n// if returns true, then delete block\nconst interact = (game, you, block, pressing) => {\n  if (block.type.collectible) {\n    you.jewels++;\n    return true;\n  }\n\n  if (block.type.deadly) {\n    game.health = Math.max(0, game.health - MAGMA_DAMAGE);\n  }\n\n  if (block.type.edible && pressing.Space) {\n    if (block.eaten === undefined) block.eaten = 1;\n    block.eaten -= game.eatSpeed;\n    game.health = Math.min(100, game.health + GRASS_HEALTH_AMT * game.eatSpeed);\n    if (block.eaten <= 0) return true;\n  }\n\n  if (block.type.diggable && pressing.Space) {\n    if (block.dug === undefined) block.dug = 1;\n    block.dug -= game.digSpeed;\n    if (block.dug <= 0) return true;\n  }\n\n  const dx = you.x - block.x;\n  const dy = you.y - block.y;\n  if (Math.abs(dx) > Math.abs(dy)) {\n    you.x = block.x + (you.x < block.x ? -1 : 1);\n    you.xs = 0;\n  } else {\n    if (you.y < block.y) you.jumping = false;\n    you.y = block.y + (you.y < block.y ? -1 : 1);\n    you.ys = 0;\n  }\n};\n\nexport class Game {\n  constructor(youPos, blocks, config) {\n    this.reset = () => {\n      this.blocks = blocks;\n      this.frame = 0;\n      this.you = {\n        x: 0,\n        y: 0,\n        xs: 0,\n        ys: 0,\n        dirX: 1,\n        dirY: 0,\n        jewels: 0,\n        ...youPos,\n      };\n\n      // these can all be overridden by config\n      this.digSpeed = 0.05;\n      this.eatSpeed = 0.05;\n      this.gravity = 0.005;\n      this.health = 100;\n      this.jumpPower = 0.11;\n      this.magmaDelay = 30;\n      this.moveSpeed = 0.015;\n      this.moveDeceleration = 0.3;\n\n      for (const x in config) {\n        if (!isNaN(config[x])) this[x] = Number(config[x]); // because editing them turns them into strings, yayyyy\n      }\n    };\n    this.reset();\n  }\n  iterate(pressing) {\n    this.iterateYou(pressing);\n    if (this.frame % this.magmaDelay === 0) this.iterateBlocks();\n    this.frame++;\n  }\n  iterateYou(pressing) {\n    const {you, blocks, gravity} = this;\n\n    if (this.health <= 0) {\n      if (pressing.Space) this.reset();\n      return;\n    }\n\n    if (pressing.KeyA || pressing.KeyD || pressing.KeyW || pressing.KeyS) {\n      you.dirX = 0;\n      you.dirY = 0;\n    }\n    if (pressing.KeyA) {\n      you.xs -= this.moveSpeed;\n      you.dirX--;\n    }\n    if (pressing.KeyD) {\n      you.xs += this.moveSpeed;\n      you.dirX++;\n    }\n    if (pressing.KeyW) {\n      if (!you.jumping) {\n        you.ys -= this.jumpPower;\n        you.jumping = true;\n      }\n      you.dirY--;\n    }\n    if (pressing.KeyS) {\n      you.dirY++;\n    }\n    you.x += you.xs;\n    you.xs *= 1 - this.moveDeceleration;\n    you.ys += gravity;\n    you.y += you.ys;\n\n    for (const key of [\n      `${Math.floor(you.x)}_${Math.floor(you.y)}`,\n      `${Math.ceil(you.x)}_${Math.floor(you.y)}`,\n      `${Math.floor(you.x)}_${Math.ceil(you.y)}`,\n      `${Math.ceil(you.x)}_${Math.ceil(you.y)}`,\n    ]) {\n      if (blocks[key]) {\n        const shouldDelete = interact(this, you, blocks[key], pressing);\n        if (shouldDelete) delete blocks[key];\n      }\n    }\n  }\n  isEmpty(x, y) {\n    return !this.blocks[`${x}_${y}`];\n  }\n  move(x, y, dx, dy) {\n    const key = `${x}_${y}`;\n    const b = this.blocks[key];\n    delete this.blocks[key];\n    b.x += dx;\n    b.y += dy;\n    this.blocks[`${b.x}_${b.y}`] = b;\n  }\n  iterateBlocks() {\n    for (const b of Object.values(this.blocks)\n      .filter((b) => b.type.movement === 'liquid')\n      .sort((a, b) => (a.y === b.y ? Math.random() - 0.5 : a.y - b.y))) {\n      if (this.isEmpty(b.x, b.y + 1)) {\n        this.move(b.x, b.y, 0, 1);\n      } else {\n        const left = this.isEmpty(b.x - 1, b.y);\n        const right = this.isEmpty(b.x + 1, b.y);\n        if (left && right) {\n          this.move(b.x, b.y, Math.random() < 0.5 ? 1 : -1, 0);\n        } else if (left) {\n          this.move(b.x, b.y, -1, 0);\n        } else if (right) {\n          this.move(b.x, b.y, 1, 0);\n        }\n      }\n    }\n  }\n}\n","const SCALE = 32;\n\nconst shadowText = (ctx, text, x, y, color, offset) => {\n  ctx.fillStyle = 'black';\n  ctx.fillText(text, x + offset, y + offset);\n  ctx.fillStyle = color;\n  ctx.fillText(text, x, y);\n};\n\nexport class Renderer {\n  constructor(canvas) {\n    this.canvas = canvas;\n    this.ctx = canvas.getContext('2d', {antialias: false, depth: false});\n    this.resize();\n    window.addEventListener('resize', () => this.resize());\n  }\n  resize() {\n    const {canvas} = this;\n    this.width = canvas.width = innerWidth;\n    this.height = canvas.height = innerHeight;\n  }\n  render({you, health, blocks}) {\n    const {ctx, width, height} = this;\n\n    ctx.clearRect(0, 0, width, height);\n    ctx.save();\n    ctx.translate(\n      width / 2 - you.x * SCALE - SCALE / 2,\n      height / 2 - you.y * SCALE - SCALE / 2\n    );\n\n    for (const {x, y, type} of Object.values(blocks)) {\n      ctx.fillStyle = type.color;\n      ctx.fillRect(x * SCALE, y * SCALE, SCALE, SCALE);\n    }\n\n    ctx.fillStyle = 'red';\n    ctx.fillRect(you.x * SCALE, you.y * SCALE, SCALE, SCALE);\n    const angle = Math.atan2(you.dirY, you.dirX);\n    ctx.strokeStyle = 'black';\n    ctx.lineWidth = 2;\n    ctx.beginPath();\n    ctx.moveTo((you.x + 0.5) * SCALE, (you.y + 0.5) * SCALE);\n    ctx.lineTo(\n      (you.x + 0.5) * SCALE + (Math.cos(angle) * SCALE) / 2,\n      (you.y + 0.5) * SCALE + (Math.sin(angle) * SCALE) / 2\n    );\n    ctx.stroke();\n\n    ctx.restore();\n\n    // HUD\n    if (health > 0) {\n      ctx.strokeStyle = 'white';\n      ctx.fillStyle = health > 30 ? 'green' : 'red';\n      ctx.fillRect(10, 10, health * 5, 20);\n      ctx.strokeRect(10, 10, 100 * 5, 20);\n      ctx.fillStyle = 'white';\n      ctx.textBaseline = 'top';\n      ctx.font = '18px sans-serif';\n      ctx.fillText(Math.round(health) + '%', 12, 11);\n    } else {\n      ctx.textBaseline = 'middle';\n      ctx.textAlign = 'center';\n      ctx.font = '120px sans-serif';\n      shadowText(ctx, 'you dead', innerWidth / 2, innerHeight / 2, 'red', 5);\n      ctx.font = '32px sans-serif';\n      shadowText(\n        ctx,\n        'press space to try again',\n        innerWidth / 2,\n        innerHeight / 2 + 60,\n        '#AFF',\n        3\n      );\n    }\n  }\n}\n","import {loadData} from '../firebase.js';\nimport {Game} from './Game.js';\nimport {Renderer} from './Renderer.js';\n\nconst init = async () => {\n  const {tileTypes, world, gameConfig} = await loadData([\n    'tileTypes',\n    'world',\n    'gameConfig',\n  ]);\n\n  const typeIndex = {};\n  let you;\n  for (const type of Object.values(tileTypes)) {\n    typeIndex[type.id] = type;\n  }\n  for (const key in world) {\n    const {x, y, tileType} = world[key];\n    if (tileType === 'w') {\n      you = {x, y};\n      delete world[key];\n    } else {\n      world[key] = {x, y, type: typeIndex[tileType]};\n    }\n  }\n\n  console.log(gameConfig);\n  const game = new Game(you, world, gameConfig);\n\n  const canvas = document.createElement('canvas');\n  document.body.append(canvas);\n  document.body.style.background = 'black';\n  document.body.style.margin = 0;\n  document.body.style.overflow = 'hidden';\n  const renderer = new Renderer(canvas);\n  const pressing = {};\n\n  const loop = () => {\n    game.iterate(pressing);\n    renderer.render(game, tileTypes);\n    requestAnimationFrame(loop);\n  };\n  loop();\n\n  const keypress = (e) => (pressing[e.code] = e.type === 'keydown');\n  window.addEventListener('keydown', keypress);\n  window.addEventListener('keyup', keypress);\n};\n\ninit();\n","// export const assocPath = ([first, ...rest], val, obj) => {\n//   const copy = Array.isArray(obj) ? [...obj] : {...obj};\n//   copy[first] = rest.length ? assocPath(rest, val, copy[first]) : val;\n//   return copy;\n// };\n\nexport const dissoc = (key, obj) => {\n  const copy = {...obj};\n  delete copy[key];\n  return copy;\n};\n\nexport const guid = () =>\n  Date.now().toString(36) + ':' + Math.random().toString(36).slice(2);\n\nexport const groupBy = (func, arr) => {\n  const res = {};\n  for (const el of arr) {\n    const key = func(el);\n    (res[key] = res[key] || []).push(el);\n  }\n  return res;\n};\n\nexport const indexBy = (func, arr) => {\n  const res = {};\n  for (const el of arr) res[func(el)] = el;\n  return res;\n};\n\nexport const objToArr = (obj = {}) =>\n  Object.entries(obj).map(([key, el]) => ({key, ...el}));\n\nexport const debounce = (func, delay) => {\n  let timeout;\n  const f = (...args) => {\n    clearTimeout(timeout);\n    timeout = setTimeout(() => func(...args), delay);\n  };\n  f.cancel = () => clearTimeout(timeout);\n  return f;\n};\n\n// export const throttle = (func, delay) => {\n//   let prev = 0;\n//   return (...args) => {\n//     const now = Date.now();\n//     if (now - prev > delay) {\n//       prev = now;\n//       return func(...args);\n//     }\n//   };\n// };\n\n// const memoize = (func) => {\n//   const cache = {};\n//   return (...args) => {\n//     const key = JSON.stringify(args);\n//     if (cache[key] === undefined) cache[key] = func(...args);\n//     return cache[key];\n//   };\n// };\n"],"names":["initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","db","getDatabase","auth","getAuth","dbRef","ref","update","updates","onError","console","log","_update","e","error","message","updateWithHistory","data","user","guid","JSON","stringify","email","tstamp","serverTimestamp","loadData","things","Object","Promise","all","map","t","get","child","val","fromEntries","listen","pathStr","onChange","r","onValue","snapshot","off","logIn","pwd","signInWithEmailAndPassword","listenUser","onAuthStateChanged","logOut","signOut","interact","game","you","block","pressing","type","collectible","jewels","deadly","health","Math","max","edible","Space","undefined","eaten","eatSpeed","min","diggable","dug","digSpeed","dx","x","dy","y","abs","xs","jumping","ys","Game","youPos","blocks","config","this","reset","frame","dirX","dirY","gravity","jumpPower","magmaDelay","moveSpeed","moveDeceleration","isNaN","Number","iterateYou","iterateBlocks","KeyA","KeyD","KeyW","KeyS","floor","ceil","key","b","values","filter","movement","sort","a","random","isEmpty","move","left","right","SCALE","shadowText","ctx","text","color","offset","fillStyle","fillText","Renderer","canvas","getContext","antialias","depth","resize","window","addEventListener","width","innerWidth","height","innerHeight","clearRect","save","translate","fillRect","angle","atan2","strokeStyle","lineWidth","beginPath","moveTo","lineTo","cos","sin","stroke","restore","strokeRect","textBaseline","font","round","textAlign","init","tileTypes","world","gameConfig","typeIndex","id","tileType","document","createElement","body","append","style","background","margin","overflow","renderer","loop","iterate","render","requestAnimationFrame","keypress","code","dissoc","obj","copy","Date","now","toString","slice","groupBy","func","arr","res","el","push","indexBy","objToArr","entries","debounce","delay","timeout","f","args","clearTimeout","setTimeout","cancel"],"sourceRoot":""}