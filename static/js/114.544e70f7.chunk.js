"use strict";(self.webpackChunkmortal_wombat=self.webpackChunkmortal_wombat||[]).push([[114],{63:function(t,e,n){n.d(e,{G9:function(){return b},Ib:function(){return g},Oz:function(){return v},Vx:function(){return m},mu:function(){return p},ni:function(){return w},oL:function(){return x}});var r=n(861),i=n(942),a=n(413),o=n(757),c=n.n(o),s=n(426),u=n(408),l=n(162),h=n(457);(0,s.ZF)({apiKey:"AIzaSyBEserPzSUos4MT3XRO8NKAO2oVk1-LS-I",authDomain:"mortal-wombat-8c76a.firebaseapp.com",projectId:"mortal-wombat-8c76a",storageBucket:"mortal-wombat-8c76a.appspot.com",messagingSenderId:"929181149015",appId:"1:929181149015:web:33a7f450bcdbb06ae64012",measurementId:"G-JL6HCMYYBS"});var f=(0,u.N8)(),y=(0,l.v0)(),d=(0,u.iH)(f),m=function(t,e){try{return console.log("updates",t),(0,u.Vx)(d,t)}catch(n){console.error(n),e(n.message)}},v=function(t,e,n){return m((0,a.Z)((0,a.Z)({},t),{},(0,i.Z)({},"history/".concat((0,h.M8)()),{update:JSON.stringify(t),user:e.email,tstamp:(0,u.Bt)()})),n)},p=function(){var t=(0,r.Z)(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=Object,t.next=3,Promise.all(e.map(function(){var t=(0,r.Z)(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,(0,u.U2)((0,u.iU)(d,e));case 3:return t.t1=t.sent.val(),t.abrupt("return",[t.t0,t.t1]);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return t.t1=t.sent,t.abrupt("return",t.t0.fromEntries.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),x=function(t,e,n){try{var r=(0,u.iH)(f,t);return(0,u.jM)(r,(function(t){return e(t.val())})),function(){return(0,u.S1)(r)}}catch(i){console.error(i),n(i.message)}},g=function(t,e){return(0,l.e5)(y,t,e)},b=function(t){return(0,l.Aj)(y,t)},w=function(){return(0,l.w7)(y)}},114:function(t,e,n){n.r(e);var r=n(861),i=n(757),a=n.n(i),o=n(63),c=n(762),s=n(413),u=n(671),l=n(144),h=function(t,e,n,r){return n.type.collectible?(e.jewels++,!0):(n.type.healing<0&&(t.health=Math.max(0,t.health+Number(n.type.healing))),!!(n.type.edible&&r.Space&&(void 0===n.eaten&&(n.eaten=1),n.eaten-=t.eatSpeed,t.health=Math.min(100,t.health+n.type.healing*t.eatSpeed),n.eaten<=0))||(!!(n.type.diggable&&r.Space&&(void 0===n.dug&&(n.dug=1),n.dug-=t.digSpeed,n.dug<=0))||void 0))},f=function(t,e,n,r){var i=e.x-n.x,a=e.y-n.y;if(Math.abs(i)>Math.abs(a)){if(h(t,e,n,r))return!0;e.x=n.x+(e.x<n.x?-1:1),e.xs=0}else{if(e.y<n.y&&(e.jumping=!1),h(t,e,n,r))return!0;e.y=n.y+(e.y<n.y?-1:1),e.ys=0}},y=function(){function t(e,n,r){for(var i in(0,u.Z)(this,t),this.blocks=n,this.frame=0,this.you=(0,s.Z)({x:0,y:0,xs:0,ys:0,dirX:1,dirY:0,jewels:0},e),this.digSpeed=.05,this.eatSpeed=.05,this.gravity=.005,this.health=100,this.jumpPower=.11,this.magmaDelay=30,this.moveSpeed=.015,this.moveDeceleration=.3,r)isNaN(r[i])||(this[i]=Number(r[i]))}return(0,l.Z)(t,[{key:"iterate",value:function(t){this.iterateYou(t),this.frame%this.magmaDelay===0&&this.iterateMagma(),this.frame++}},{key:"iterateYou",value:function(t){var e=this.you,n=this.blocks,r=this.gravity;if(this.health<=0)t.KeyR&&location.reload();else{(t.KeyA||t.KeyD||t.KeyW||t.KeyS)&&(e.dirX=0,e.dirY=0),t.KeyA&&(e.xs-=this.moveSpeed,e.dirX--),t.KeyD&&(e.xs+=this.moveSpeed,e.dirX++),t.KeyW&&(e.jumping||(e.ys-=this.jumpPower,e.jumping=!0),e.dirY--),t.KeyS&&e.dirY++,e.x+=e.xs,e.xs*=1-this.moveDeceleration,e.ys+=r,e.y+=e.ys;for(var i=0,a=["".concat(Math.floor(e.x),"_").concat(Math.floor(e.y)),"".concat(Math.ceil(e.x),"_").concat(Math.floor(e.y)),"".concat(Math.floor(e.x),"_").concat(Math.ceil(e.y)),"".concat(Math.ceil(e.x),"_").concat(Math.ceil(e.y))];i<a.length;i++){var o=a[i];if(n[o])f(this,e,n[o],t)&&delete n[o]}}}},{key:"isEmpty",value:function(t,e){return!this.blocks["".concat(t,"_").concat(e)]}},{key:"move",value:function(t,e,n,r){var i="".concat(t,"_").concat(e),a=this.blocks[i];delete this.blocks[i],a.x+=n,a.y+=r,this.blocks["".concat(a.x,"_").concat(a.y)]=a}},{key:"iterateMagma",value:function(){var t,e=Object.values(this.blocks).filter((function(t){return"liquid"===t.type.movement})).sort((function(t,e){return t.y===e.y?Math.random()-.5:t.y-e.y})),n=(0,c.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.isEmpty(r.x,r.y+1))this.move(r.x,r.y,0,1);else{var i=this.isEmpty(r.x-1,r.y),a=this.isEmpty(r.x+1,r.y);i&&a?this.move(r.x,r.y,Math.random()<.5?1:-1,0):i?this.move(r.x,r.y,-1,0):a&&this.move(r.x,r.y,1,0)}}}catch(o){n.e(o)}finally{n.f()}}}]),t}(),d=32,m=function(t,e,n,r,i,a){t.fillStyle="black",t.fillText(e,n+a,r+a),t.fillStyle=i,t.fillText(e,n,r)},v=function(){function t(e){var n=this;(0,u.Z)(this,t),this.canvas=e,this.ctx=e.getContext("2d",{antialias:!1,depth:!1}),this.resize(),window.addEventListener("resize",(function(){return n.resize()}))}return(0,l.Z)(t,[{key:"resize",value:function(){var t=this.canvas;this.width=t.width=innerWidth,this.height=t.height=innerHeight}},{key:"render",value:function(t){var e=t.you,n=t.health,r=t.blocks,i=this.ctx,a=this.width,o=this.height;i.clearRect(0,0,a,o),i.save(),i.translate(a/2-e.x*d-16,o/2-e.y*d-16);for(var c=0,s=Object.values(r);c<s.length;c++){var u=s[c],l=u.x,h=u.y,f=u.type;i.fillStyle=f.color,i.fillRect(l*d,h*d,d,d)}i.fillStyle="red",i.fillRect(e.x*d,e.y*d,d,d);var y=Math.atan2(e.dirY,e.dirX);i.strokeStyle="black",i.lineWidth=2,i.beginPath(),i.moveTo((e.x+.5)*d,(e.y+.5)*d),i.lineTo((e.x+.5)*d+Math.cos(y)*d/2,(e.y+.5)*d+Math.sin(y)*d/2),i.stroke(),i.restore(),n>0?(i.strokeStyle="white",i.fillStyle=n>30?"green":"red",i.fillRect(10,10,5*n,20),i.strokeRect(10,10,500,20),i.fillStyle="white",i.textBaseline="top",i.font="18px sans-serif",i.textAlign="left",i.textBaseline="top",i.fillText(Math.round(n)+"%",12,11)):(i.textBaseline="middle",i.textAlign="center",i.font="120px sans-serif",m(i,"you dead",innerWidth/2,innerHeight/2,"red",5),i.font="32px sans-serif",m(i,"press R to try again",innerWidth/2,innerHeight/2+60,"#AFF",3))}}]),t}(),p=function(){var t=(0,r.Z)(a().mark((function t(){var e,n,r,i,c,s,u,l,h,f,d,m,p,x,g,b,w,k,S;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.mu)(["tileTypes","world","gameConfig"]);case 2:for(e=t.sent,n=e.tileTypes,r=e.world,i=e.gameConfig,c={},u=0,l=Object.values(n);u<l.length;u++)h=l[u],c[h.id]=h;for(f in r)d=r[f],m=d.x,p=d.y,"w"===(x=d.tileType)?(s={x:m,y:p},delete r[f]):r[f]={x:m,y:p,type:c[x]};console.log(i),g=new y(s,r,i),b=document.createElement("canvas"),document.body.append(b),document.body.style.background="black",document.body.style.margin=0,document.body.style.overflow="hidden",w=new v(b),k={},function t(){g.iterate(k),w.render(g,n),requestAnimationFrame(t)}(),S=function(t){return k[t.code]="keydown"===t.type},window.addEventListener("keydown",S),window.addEventListener("keyup",S);case 23:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();p()},457:function(t,e,n){n.d(e,{Ds:function(){return h},HK:function(){return u},M8:function(){return c},aW:function(){return l},an:function(){return o},vM:function(){return s}});var r=n(885),i=n(762),a=n(413),o=function(t,e){var n=(0,a.Z)({},e);return delete n[t],n},c=function(){return Date.now().toString(36)+":"+Math.random().toString(36).slice(2)},s=function(t,e){var n,r={},a=(0,i.Z)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value,c=t(o);(r[c]=r[c]||[]).push(o)}}catch(s){a.e(s)}finally{a.f()}return r},u=function(t,e){var n,r={},a=(0,i.Z)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;r[t(o)]=o}}catch(c){a.e(c)}finally{a.f()}return r},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(t).map((function(t){var e=(0,r.Z)(t,2),n=e[0],i=e[1];return(0,a.Z)({key:n},i)}))},h=function(t,e){var n,r=function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];clearTimeout(n),n=setTimeout((function(){return t.apply(void 0,i)}),e)};return r.cancel=function(){return clearTimeout(n)},r}}}]);
//# sourceMappingURL=114.544e70f7.chunk.js.map